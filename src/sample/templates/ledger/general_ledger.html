{% extends "base.html" %}

{% block main %}

<head>
  <meta charset="utf-8">
  <title>総勘定元帳</title>
  <script src="https://unpkg.com/htmx.org@2.0.0"
    integrity="sha384-wS5l5IKJBvK6sPTKa2WZ1js3d947pvWXbPJ1OmWfEuxLgeHcEbjUUA5i9V5ZkpCw" crossorigin="anonymous"></script>
</head>

<h2>総勘定元帳</h2>
<!-- <h3>勘定科目: {{ account_name }}</h3> -->
<div id="ledger-controls"
  hx-target="#search-result"
  hx-swap="innerHTML"
  hx-trigger="change"
  hx-get="{% url 'general_ledger_by_account' %}"
  hx-include="#year_month, #account_name"
  class="mb-3"
>
  <label for="year_month">年月:</label>
  <input type="month" id="year_month" name="year_month" value="{{ year_month }}">
  <label for="account_name">勘定科目:</label>
  <input type="text" id="account_name" name="account_name" value="{{ account_name }}">
  <button type="button" id="pdf-btn" class="btn btn-secondary btn-sm">PDF出力</button>
</div>

<script>
  document.getElementById('pdf-btn').addEventListener('click', function () {
    var yearMonth = document.getElementById('year_month').value;
    if (!yearMonth) {
      alert('年月を入力してください。');
      return;
    }
    window.location.href = "{% url 'ledger_pdf' %}?year_month=" + yearMonth;
  });
</script>

<table id="search-result" class="table table-striped">
  <thead>
    <tr>
      <th>日付</th>
      <th>摘要</th>
      <th>借方金額</th>
      <th>貸方金額</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>

{% endblock %}